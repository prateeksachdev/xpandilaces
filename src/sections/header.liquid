{%- comment -%}
  This is a required section for the Shopify Theme Store.
  It is available in the "Header" section in the theme editor.

  Theme Store required settings
  - Show announcement
  - Text: message to announce
  - Link: link of the announcement bar

  Theme Store optional settings
  - Home page only: only shows on the home page
{%- endcomment -%}
<nav id="navbar" v-cloak class="navbar is-fixed-top rows" role="navigation" data-section-id="{{ section.id }}" data-section-type="header">
  {%- if section.settings.announcement_bar_enabled -%}
    <height-transition>
      <div v-if="isAnnouncementVisible" class="row announcement">
        <div class="container has-text-centered">
          <div class="text-wrap">
            <img class="announcement-icon" src="{{ 'box.svg' | asset_url }}">
            {{ section.settings.shipping_text }}
          </div>

          <div class="text-wrap">
            <i class="announcement-icon fa fa-heart"></i>
            {{ section.settings.promo_text }}
          </div>
        </div>

        <a @click="hideAnnouncement" href="javascript:;" class="close">
          <i class="fa fa-times"></i>
        </a>
      </div>
    </height-transition>
  {%- endif -%}

  <div class="row menu">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item logo" href="{{ shop.url }}">
          <img src="{{ section.settings.logo | img_url: '200x' }}" alt="{{ shop.name | escape }}">
        </a>

        <a class="navbar-item mobile" href="javascript:;" @click="toggleMobileMega">
          SHOP
          <span class="icon-down-arrow">
        </a>
      </div>

      <div class="navbar-menu primary">
        <div class="navbar-start">
          {% for link in linklists[section.settings.primary_menu].links %}
            <a @mouseenter="showDesktopMega" class="navbar-item" href="{{ link.url }}">
              {{ link.title }}
              <span class="icon-down-arrow">
            </a>
          {% endfor %}
        </div>
      </div>

      <div class="navbar-menu secondary">
        <div class="navbar-start">
          {% for link in linklists[section.settings.secondary_menu].links %}
            <a class="navbar-item" href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}

          {% if shop.customer_accounts_enabled %}
            <a class="navbar-item" href="/account">
              {% if customer %}
                {{ 'layout.customer.my_account' | t }}
              {% else %}
                {{ 'layout.customer.log_in' | t }}
              {% endif %}
            </a>
          {% endif %}
        </div>
      </div>

      <div class="navbar-icons">
        <a @click="toggleSearch" class="navbar-item search">
          <img src="{{ 'search.png' | asset_url }}" alt="{{ 'general.search.title' | t }}">
        </a>

        <a @click="toggleCartDetail" class="navbar-item cart">
          <img src="{{ 'cart.png' | asset_url }}" alt="{{ 'cart.general.title' | t }}">
          <span class="cart-count">{{ cart.item_count }}</span>
        </a>
      </div>
    </div>
  </div>

  <transition name="fade">
    <div v-show="isMobileMegaVisible" class="row mega-drop mobile">
      <div class="columns is-mobile">
        {% for block in section.blocks %}
          {% if block.settings.enable_block %}
            <div class="column">
              <a href="javascript:;" class="item">
                <img src="{{ block.settings.image | img_url: '400x' }}">
                <h3>{{ block.settings.name }}</h3>
                {{ block.settings.caption }}
              </a>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <ul class="menu">
        {% for link in linklists[section.settings.secondary_menu].links %}
          <li>
            <a href="{{ link.url }}">
              {{ link.title }}
            </a>
          </li>
        {% endfor %}

        <li>
          {% assign link = linklists[section.settings.mobile_menu].links.first %}
          <a href="{{ link.url }}">
            {{ link.title }}
          </a>
        </li>

        <li>
          <a @click="toggleMobileMore" href="javascript:;">
            More
            <span class="icon-down-arrow">
          </a>

          <height-transition>
            <ul v-if="isMobileMoreExpanded" class="more">
              {% for link in linklists[section.settings.mobile_menu].links %}
                {% unless forloop.first %}
                  <li>
                    <a href="{{ link.url }}">
                      {{ link.title }}
                    </a>
                  </li>
                {% endunless %}
              {% endfor %}
            </ul>
          </height-transition>
        </li>

        {% if shop.customer_accounts_enabled %}
          {% if customer %}
            <li>
              <a href="/account">{{ customer.name }}</a>
            </li>
            <li>
              {{ 'layout.customer.log_out' | t | customer_logout_link }}
            </li>
          {% else %}
            <li>
              {{ 'layout.customer.log_in' | t | customer_login_link }}
            </li>
          {% endif %}
        {% endif %}
      </ul>
    </div>
  </transition>

  <div v-show="isDesktopMegaVisible" @mouseleave="hideDesktopMega" class="row mega-drop desktop">
    {% for block in section.blocks %}
      {% if block.settings.enable_block %}
        <a href="javascript:;" class="item">
          <img src="{{ block.settings.image | img_url: 'x200' }}">
          <h3>{{ block.settings.name }}</h3>
          {{ block.settings.caption }}
        </a>
      {% endif %}
    {% endfor %}
  </div>

  <transition name="fade">
    <div v-if="isCartDetailVisible" class="row mobile cart-detail">
      <div class="drawer" v-click-outside="hideCartDetail">
        <a @click="hideCartDetail" href="javascript:;" class="continue-shopping">
          {{ 'cart.general.continue_shopping_link_html' | t }}
        </a>

        <ul>
          {% for item in cart.items %}
            <li class="cart-item">
              <a href="{{ item.url}}">
                <div class="image">
                  <img src="{{ item | img_url: '160x' }}" alt="{{ item.title | escape }}">
                </div>
                <div class="title">
                  <span>{{ item.product.title }}</span>
                </div>
                <div class="price">
                  <span>{{ item.price | money}}</span>
                </div>
              </a>

              <div class="quantity">
                <div class="field has-addons">
                  <p class="control">
                    <a class="button">
                      <span class="icon-minus"></span>
                    </a>
                  </p>
                  <p class="control">
                    <input class="input" type="text" size="2" value="{{ item.quantity }}">
                  </p>
                  <p class="control">
                    <a class="button">
                      <span class="icon-plus"></span>
                    </a>
                  </p>
                </div>
              </div>
            </li>
          {% endfor %}
        </ul>

        <div class="foot">
          <p class="subtotal">
            <span>{{ 'layout.general.subtotal' | t }}</span>
            <span class="is-pulled-right">{{ cart.total_price | money }}</span>
          </p>
          <p class="text-center">
            <a class="button" href="/cart">
              {{ 'layout.general.go_to_cart' | t }}
            </a>
          </p>
        </div>
      </div>
    </div>
  </transition>

  <transition name="fade">
    <div v-if="isSearchVisible" class="row search">
      <form action="/search">
        {% if settings.search_option != 'everything' %}
          <input type="hidden" name="type" value="product" />
        {% endif %}

        <div class="control has-icons-right">
          <input class="input" type="text" name="q" placeholder="{{ 'general.search.title' | t: shop_name: shop.name }}" autocapitalize="off" autocomplete="off" autocorrect="off">
          <button class="icon-search icon is-right is-large" type="submit"></button>
        </div>
      </form>
    </div>
  </transition>

<!--   <header role="banner">
    {% if template.name == 'index' %}
      <h1>
    {% else %}
      <div class="h1">
    {% endif %}
        <a href="/" class="logo-image">
          {% if section.settings.logo != blank %}
            {% capture image_size %}{{ section.settings.logo_max_width }}x{% endcapture %}
            <img src="{{ section.settings.logo | img_url: image_size }}"
                srcset="{{ section.settings.logo | img_url: image_size }} 1x, {{ section.settings.logo | img_url: image_size, scale: 2 }} 2x"
                alt="{{ section.settings.logo.alt | default: shop.name }}">
          {% else %}
            {{ shop.name }}
          {% endif %}
        </a>
    {% if template.name == 'index' %}
      </h1>
    {% else %}
      </div>
    {% endif %}

    <a href="/cart">
      {% include 'icon-cart' %}
      {{ 'layout.cart.title' | t }}
      ({{ cart.item_count }} {{ 'layout.cart.items_count' | t: count: cart.item_count }})
    </a>

    {% if shop.customer_accounts_enabled %}
      <ul>
        {% if customer %}
          <li>
            {% if customer.first_name != blank %}
              {% capture first_name %}<a href="/account">{{ customer.first_name }}</a>{% endcapture %}
              {{ 'layout.customer.logged_in_as_html' | t: first_name: first_name }}
            {% else %}
              <a href="/account">{{ 'layout.customer.account' | t }}</a>
            {% endif %}
          </li>
          <li>
            {{ 'layout.customer.log_out' | t | customer_logout_link }}
          </li>
        {% else %}
          <li>
            {{ 'layout.customer.log_in' | t | customer_login_link }}
          </li>
          <li>
            {{ 'layout.customer.create_account' | t | customer_register_link }}
          </li>
        {% endif %}
      </ul>
    {% endif %}

    <form action="/search" method="get" role="search">
      <label for="Search-{{ section.id }}" class="label-hidden">
        {{ 'general.search.placeholder' | t }}
      </label>

      <input type="search"
        name="q"
        id="Search-{{ section.id }}"
        value="{{ search.terms | escape }}"
        placeholder="{{ 'general.search.placeholder' | t }}">

      <button type="submit" class="button">
        {% include 'icon-search' %}
        <span class="icon-fallback-text">{{ 'general.search.submit' | t }}</span>
      </button>
    </form>
  </header>

  <nav role="navigation">
    <ul>
      {% for link in linklists[section.settings.menu].links %}
        {% if link.links != blank %}
          <li>
            <a href="{{ link.url }}">
              {{ link.title }}
              {% include 'icon-arrow-down' %}
            </a>
            <ul>
              {% for childlink in link.links %}
                <li>
                  <a href="{{ childlink.url }}">
                    {{ childlink.title }}
                  </a>
                </li>
              {% endfor %}
            </ul>
          </li>
        {% else %}
          <li>
            <a href="{{ link.url }}">
              {{ link.title }}
            </a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </nav> -->
</nav>

<!-- Roy -->
{% schema %}
  {
    "name": "Header",
    "settings": [
      {
        "type": "header",
        "content": "Announcement Bar"
      },
      {
        "type": "checkbox",
        "id": "announcement_bar_enabled",
        "label": "Show Announcement Bar",
        "default": true
      },
      {
        "type": "richtext",
        "id": "shipping_text",
        "label": "Shipping Text"
      },
      {
        "type": "richtext",
        "id": "promo_text",
        "label": "Promo Text"
      },
      {
        "type": "header",
        "content": "Header"
      },
      {
        "type": "image_picker",
        "id": "logo",
        "label": "Logo image"
      },
      {
        "type": "link_list",
        "id": "primary_menu",
        "label": "Primary Menu"
      },
      {
        "type": "link_list",
        "id": "secondary_menu",
        "label": "Secondary Menu"
      },
      {
        "type": "link_list",
        "id": "mobile_menu",
        "label": "Mobile Menu"
      }
    ],
    "max_blocks": 4,
    "blocks": [
      {
        "type": "mega_item",
        "name": "Mega Item",
        "settings": [
          {
            "type":"checkbox",
            "id":"enable_block",
            "label":"Enable Block",
            "default": true
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "name",
            "label": "Name"
          },
          {
            "type": "richtext",
            "id": "caption",
            "label": "Caption"
          },
          {
            "type": "url",
            "id": "link",
            "label": "Link"
          }
        ]
      }
    ]
  }
{% endschema %}

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "{{ shop.name }}",
  {% if section.settings.logo %}
    {% assign image_size = section.settings.logo.width | append:'x' %}
    "logo": "https:{{ section.settings.logo | img_url: image_size }}",
  {% endif %}
  "sameAs": [
    "{{ settings.social_twitter_link }}",
    "{{ settings.social_facebook_link }}",
    "{{ settings.social_pinterest_link }}",
    "{{ settings.social_instagram_link }}",
    "{{ settings.social_tumblr_link }}",
    "{{ settings.social_snapchat_link }}",
    "{{ settings.social_youtube_link }}",
    "{{ settings.social_vimeo_link }}"
  ],
  "url": "{{ shop.url }}{{ page.url }}"
}
</script>

{% if template.name == 'index' %}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": "{{ shop.name }}",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ shop.url }}/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "url": "{{ shop.url }}{{ page.url }}"
    }
  </script>
{% endif %}
